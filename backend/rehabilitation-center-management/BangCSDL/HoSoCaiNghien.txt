
-- ================================
-- CSDL HỒ SƠ CAI NGHIỆN MA TÚY
-- ================================

-- A. Bảng Người Cai Nghiện (Thông tin cơ bản)
CREATE TABLE NguoiCaiNghien (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    SoCCCD VARCHAR2(20),
    HoTen VARCHAR2(255),
    TenGoiKhac VARCHAR2(255),
    NgaySinh DATE,
    GioiTinh VARCHAR2(10),
    NoiSinh VARCHAR2(255),
    NoiDKKhaiSinh VARCHAR2(255),
    QueQuan VARCHAR2(255),
    DanToc VARCHAR2(50),
    TonGiao VARCHAR2(50),
    QuocTich VARCHAR2(50),
    NhomMau VARCHAR2(10),
    NgayCapCCCD DATE,
    NoiCapCCCD VARCHAR2(255),
    NgayHetHanCCCD DATE,
    NoiThuongTru VARCHAR2(255),
    NoiTamTru VARCHAR2(255),
    NoiOHienTai VARCHAR2(255),
    TinhTrangHonNhan VARCHAR2(50),
    SoCMND9So VARCHAR2(20),

    TrinhDoDaoTao VARCHAR2(255),
    NgheNghiep VARCHAR2(255),
    NoiLamViec VARCHAR2(255),
    VanBangChungChi VARCHAR2(255),
    TrinhTrangChuyenMon VARCHAR2(255)
);

-- B. Tiền án
CREATE TABLE TienAn (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    TongSoTienAn VARCHAR2(10),
    TaiPham VARCHAR2(10),
    NamXu VARCHAR2(10),
    ToaXu VARCHAR2(100),
    DiaPhuong VARCHAR2(100),
    ToiDanh VARCHAR2(255),
    MucAn VARCHAR2(100),
    NoiChapHanh VARCHAR2(255),
    NamTha VARCHAR2(10),
    TinhTrang VARCHAR2(100),
    GhiChu VARCHAR2(255),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- C. Tiền sự
CREATE TABLE TienSu (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    SoTienSu VARCHAR2(10),
    GhiChuTienSu VARCHAR2(255),
    ThoiGian DATE,
    SoQD VARCHAR2(50),
    NgayQD DATE,
    HanhViViPham VARCHAR2(255),
    DonViXuLy VARCHAR2(255),
    HinhThucXuLy VARCHAR2(255),
    NoiChapHanh VARCHAR2(255),
    BatDau VARCHAR2(50),
    KetThuc VARCHAR2(50),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- D. Cai nghiện tổng quan
CREATE TABLE CaiNghienTongQuan (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    TongSoLanCai VARCHAR2(10),
    NamBatDauCai VARCHAR2(10),
    TongThoiGianCai DATE,
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- E. Tiền lưu ký - vào
CREATE TABLE TienLuuKyVao (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    PhanLoai VARCHAR2(255),
    ThoiGianGui DATE,
    NguoiGui VARCHAR2(255),
    GiaTriSoTien VARCHAR2(50),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- F. Tiền lưu ký - ra
CREATE TABLE TienLuuKyRa (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    PhanLoai VARCHAR2(255),
    ThoiGianGhiNhan DATE,
    GiaTriSoTien VARCHAR2(50),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- G. Giáo dục & Tư vấn
CREATE TABLE GiaoDucTuVan (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    Loai VARCHAR2(20), -- GIAODUC or TUVAN
    TenChuongTrinh VARCHAR2(255),
    ThoiGianBatDau DATE,
    ThoiGianKetThuc DATE,
    DiemTrungBinh VARCHAR2(10),
    XepLoai VARCHAR2(50),
    GiaoVien VARCHAR2(255),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- H. Đánh giá định kỳ
CREATE TABLE DanhGiaDinhKy (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    LoaiDanhGia VARCHAR2(50),
    Tuan VARCHAR2(10),
    Thang VARCHAR2(10),
    Quy VARCHAR2(10),
    ThoiGianXetDuyet DATE,
    TongDiem VARCHAR2(10),
    KetQuaXepLoai VARCHAR2(50),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- I. Quan Trang
CREATE TABLE QuanTrang (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    Ma VARCHAR2(50),
    TenQuanTrang VARCHAR2(255),
    LoaiQuanTrang VARCHAR2(100),
    DonViTinh VARCHAR2(50),
    TongSoLuong VARCHAR2(50),
    TinhTrang VARCHAR2(100),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- I.1. Bàn giao quân trang
CREATE TABLE BanGiaoQuanTrang (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    QuanTrangID NUMBER,
    SoLuong VARCHAR2(50),
    NguoiBanGiao VARCHAR2(255),
    NgayBanGiao DATE,
    FOREIGN KEY (QuanTrangID) REFERENCES QuanTrang(ID)
);

-- J. Dao Tao Nghe
CREATE TABLE DaoTaoNghe (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    MaLopHoc VARCHAR2(50),
    TenKhoaHoc VARCHAR2(255),
    LoaiNghe VARCHAR2(100),
    TenLopHoc VARCHAR2(255),
    ThoiGianBatDau DATE,
    ThoiGianKetThuc DATE,
    DiemTrungBinh VARCHAR2(10),
    XepLoai VARCHAR2(50),
    TinhTrangChungChi VARCHAR2(100),
    MaChungChi VARCHAR2(50),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- J.1. Lao Dong Tri Lieu
CREATE TABLE LaoDongTriLieu (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    SoLanDiLaoDong VARCHAR2(10),
    NoiLaoDong VARCHAR2(255),
    TongNgayCong VARCHAR2(10),
    TenChungChi VARCHAR2(255),
    ThoiGianCapChungChi DATE,
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- K. Tham Gap
CREATE TABLE ThamGap (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    ThoiGianTham DATE,
    TenThanNhan VARCHAR2(255),
    CCCDThanNhan VARCHAR2(20),
    LoaiThamGap VARCHAR2(100),
    MoiQuanHe VARCHAR2(100),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- L. Moi Quan He
CREATE TABLE MoiQuanHe (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    CCCD VARCHAR2(20),
    LoaiQuanHe VARCHAR2(100),
    ChiTietQuanHe VARCHAR2(255),
    HoTen VARCHAR2(255),
    NgaySinh DATE,
    GioiTinh VARCHAR2(10),
    QueQuan VARCHAR2(255),
    DanToc VARCHAR2(50),
    TonGiao VARCHAR2(50),
    QuocTich VARCHAR2(50),
    NhomMau VARCHAR2(10),
    NgayCapCCCD DATE,
    NoiCapCCCD VARCHAR2(255),
    NgayHetHanCCCD DATE,
    NoiThuongTru VARCHAR2(255),
    NoiTamTru VARCHAR2(255),
    NoiOHienTai VARCHAR2(255),
    TinhTrangHonNhan VARCHAR2(50),
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- M. Tai Hoa Nhap Cong Dong
CREATE TABLE TaiHoaNhap (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    ThoiGianDanhGia DATE,
    DanhGiaYTe VARCHAR2(255),
    DanhGiaPhucHoi VARCHAR2(255),
    DanhGiaGiaoDuc VARCHAR2(255),
    DanhGiaNghe VARCHAR2(255),
    DanhGiaTaiHoaNhap VARCHAR2(255),
    LoaiXacNhan VARCHAR2(100),
    SoXacNhan VARCHAR2(100),
    ThoiGianCap DATE,
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);

-- N. Quan Ly Sau Cai
CREATE TABLE QuanLySauCai (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    NguoiID NUMBER,
    ToChucQuanLy VARCHAR2(255),
    ThoiGianDeXuat DATE,
    FOREIGN KEY (NguoiID) REFERENCES NguoiCaiNghien(ID)
);
